# Vulnerability Mapping to Security Tools

## Complete Vulnerability List (30+ Issues)

### Critical Vulnerabilities

#### 1. SQL Injection (Multiple Locations)
**Location**: `pages/login.php`, `pages/register.php`, `pages/dashboard.php`, `pages/post.php`, `api/api.php`

**Detectable By**:
- ✅ **OWASP ZAP**: Active scan detects SQL injection in forms
- ✅ **SonarQube**: Static analysis finds concatenated SQL queries
- ✅ **Threat Dragon**: Listed as "SQL Injection" threat
- ❌ **Dependency-Check**: N/A (not a dependency issue)
- ❌ **BlackDuck**: N/A (not a dependency issue)

**CWE**: CWE-89 - SQL Injection  
**OWASP Top 10**: A03:2021 - Injection

---

#### 2. Cross-Site Scripting (XSS) - Stored
**Location**: `pages/dashboard.php`, `pages/post.php`

**Detectable By**:
- ✅ **OWASP ZAP**: Detects stored XSS in post creation
- ✅ **SonarQube**: Flags unencoded output
- ✅ **Threat Dragon**: Listed as "XSS" threat
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-79 - Cross-site Scripting  
**OWASP Top 10**: A03:2021 - Injection

---

#### 3. Cross-Site Scripting (XSS) - Reflected
**Location**: `pages/dashboard.php` (search parameter)

**Detectable By**:
- ✅ **OWASP ZAP**: Detects reflected XSS in search
- ✅ **SonarQube**: Flags unencoded output
- ✅ **Threat Dragon**: Listed as threat
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-79  
**OWASP Top 10**: A03:2021 - Injection

---

#### 4. Cross-Site Scripting (XSS) - DOM-based
**Location**: `assets/js/app.js`

**Detectable By**:
- ✅ **OWASP ZAP**: May detect during spider/scan
- ✅ **SonarQube**: Flags unsafe DOM manipulation
- ❌ **Threat Dragon**: Requires manual modeling
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-79  
**OWASP Top 10**: A03:2021 - Injection

---

#### 5. Hardcoded Database Credentials
**Location**: `config.php`, `docker-compose.yml`

**Detectable By**:
- ❌ **OWASP ZAP**: Cannot detect hardcoded credentials in source
- ✅ **SonarQube**: Detects hardcoded passwords (S2068)
- ✅ **Threat Dragon**: Listed as "Hardcoded Credentials" threat
- ❌ **Dependency-Check**: N/A
- ⚠️ **BlackDuck**: May detect in configuration files

**CWE**: CWE-798 - Use of Hard-coded Credentials  
**OWASP Top 10**: A07:2021 - Identification and Authentication Failures

---

#### 6. Hardcoded API Keys
**Location**: `config.php`

**Detectable By**:
- ❌ **OWASP ZAP**: Cannot detect in source code
- ✅ **SonarQube**: Detects hardcoded secrets
- ✅ **Threat Dragon**: Listed as threat
- ❌ **Dependency-Check**: N/A
- ⚠️ **BlackDuck**: May detect in source scan

**CWE**: CWE-798  
**OWASP Top 10**: A07:2021 - Identification and Authentication Failures

---

#### 7. Plain Text Password Storage
**Location**: `config.php`, `pages/register.php`

**Detectable By**:
- ⚠️ **OWASP ZAP**: May detect via password exposure
- ✅ **SonarQube**: Detects lack of password hashing
- ✅ **Threat Dragon**: Listed as "Plain Text Password Storage"
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-259 - Use of Hard-coded Password  
**OWASP Top 10**: A02:2021 - Cryptographic Failures

---

#### 8. Unrestricted File Upload
**Location**: `pages/upload.php`

**Detectable By**:
- ✅ **OWASP ZAP**: Detects file upload without validation
- ✅ **SonarQube**: May flag missing validation
- ✅ **Threat Dragon**: Listed as "Unrestricted File Upload"
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-434 - Unrestricted Upload of File with Dangerous Type  
**OWASP Top 10**: A04:2021 - Insecure Design

---

#### 9. Remote Code Execution via File Upload
**Location**: `pages/upload.php`

**Detectable By**:
- ✅ **OWASP ZAP**: Active scan may detect
- ✅ **SonarQube**: Flags dangerous file operations
- ✅ **Threat Dragon**: Listed as threat
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-94 - Code Injection  
**OWASP Top 10**: A03:2021 - Injection

---

### High Severity Vulnerabilities

#### 10. Insecure Direct Object Reference (IDOR)
**Location**: `pages/profile.php`

**Detectable By**:
- ✅ **OWASP ZAP**: Detects via access control testing
- ⚠️ **SonarQube**: May flag missing authorization
- ✅ **Threat Dragon**: Listed as "IDOR Vulnerability"
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-639 - Insecure Direct Object Reference  
**OWASP Top 10**: A01:2021 - Broken Access Control

---

#### 11. Missing Authentication
**Location**: `pages/dashboard.php`, `pages/admin.php`, `api/api.php`

**Detectable By**:
- ✅ **OWASP ZAP**: Detects unprotected pages
- ✅ **SonarQube**: May flag missing security checks
- ✅ **Threat Dragon**: Listed as "Missing Authentication"
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-306 - Missing Authentication for Critical Function  
**OWASP Top 10**: A07:2021 - Identification and Authentication Failures

---

#### 12. Weak Authorization
**Location**: `pages/admin.php`

**Detectable By**:
- ✅ **OWASP ZAP**: Detects via authorization testing
- ✅ **SonarQube**: Flags weak authorization logic
- ✅ **Threat Dragon**: Listed as threat
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-285 - Improper Authorization  
**OWASP Top 10**: A01:2021 - Broken Access Control

---

#### 13. Missing CSRF Protection
**Location**: All forms in `pages/`

**Detectable By**:
- ✅ **OWASP ZAP**: Detects missing anti-CSRF tokens
- ✅ **SonarQube**: May flag forms without CSRF
- ✅ **Threat Dragon**: Listed as "Missing CSRF Protection"
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-352 - Cross-Site Request Forgery  
**OWASP Top 10**: A01:2021 - Broken Access Control

---

#### 14. Session Fixation
**Location**: `pages/login.php`

**Detectable By**:
- ✅ **OWASP ZAP**: May detect via session testing
- ✅ **SonarQube**: Flags missing session regeneration
- ✅ **Threat Dragon**: Listed as threat
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-384 - Session Fixation  
**OWASP Top 10**: A07:2021 - Identification and Authentication Failures

---

#### 15. Insecure Session Management
**Location**: `config.php`

**Detectable By**:
- ✅ **OWASP ZAP**: Detects missing cookie flags
- ✅ **SonarQube**: Flags insecure session config
- ✅ **Threat Dragon**: Listed as "Session Hijacking"
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-614 - Sensitive Cookie Without 'HttpOnly' Flag  
**OWASP Top 10**: A07:2021 - Identification and Authentication Failures

---

#### 16. Information Disclosure - Debug Mode
**Location**: `config.php`

**Detectable By**:
- ✅ **OWASP ZAP**: Detects error messages
- ✅ **SonarQube**: Flags debug mode enabled
- ✅ **Threat Dragon**: Listed as "Information Disclosure"
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-209 - Information Exposure Through Error Message  
**OWASP Top 10**: A05:2021 - Security Misconfiguration

---

#### 17. Path Traversal
**Location**: `index.php`, `pages/upload.php`

**Detectable By**:
- ✅ **OWASP ZAP**: Detects path traversal attempts
- ✅ **SonarQube**: Flags unsafe file operations
- ✅ **Threat Dragon**: Listed as "Path Traversal"
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-22 - Path Traversal  
**OWASP Top 10**: A01:2021 - Broken Access Control

---

### Medium Severity Vulnerabilities

#### 18. Vulnerable Dependencies - jQuery 1.9.1
**Location**: `pages/dashboard.php`

**Detectable By**:
- ❌ **OWASP ZAP**: Limited detection of client libraries
- ⚠️ **SonarQube**: May detect outdated libraries
- ❌ **Threat Dragon**: Requires manual modeling
- ✅ **Dependency-Check**: **PRIMARY DETECTOR** (CVE-2015-9251, CVE-2019-11358)
- ✅ **BlackDuck**: **PRIMARY DETECTOR** - Detects vulnerable jQuery

**CVE**: CVE-2015-9251, CVE-2019-11358  
**OWASP Top 10**: A06:2021 - Vulnerable and Outdated Components

---

#### 19. Vulnerable Dependencies - PHP 7.2
**Location**: `Dockerfile`

**Detectable By**:
- ❌ **OWASP ZAP**: Cannot detect server version typically
- ⚠️ **SonarQube**: May flag EOL PHP version
- ❌ **Threat Dragon**: Requires manual entry
- ✅ **Dependency-Check**: Detects PHP vulnerabilities
- ✅ **BlackDuck**: **PRIMARY DETECTOR** - Detects outdated PHP

**CVE**: Multiple (PHP 7.2 EOL)  
**OWASP Top 10**: A06:2021 - Vulnerable and Outdated Components

---

#### 20. Vulnerable Dependencies - Composer Packages
**Location**: `composer.json`

**Detectable By**:
- ❌ **OWASP ZAP**: N/A
- ✅ **SonarQube**: May detect via plugins
- ❌ **Threat Dragon**: Manual
- ✅ **Dependency-Check**: **PRIMARY DETECTOR**
- ✅ **BlackDuck**: **PRIMARY DETECTOR**

**Packages**: monolog 1.23.0, symfony/yaml 3.4.0, twig 1.42.0, doctrine/dbal 2.9.0  
**OWASP Top 10**: A06:2021 - Vulnerable and Outdated Components

---

#### 21. CORS Misconfiguration
**Location**: `api/api.php`

**Detectable By**:
- ✅ **OWASP ZAP**: Detects permissive CORS
- ✅ **SonarQube**: May flag CORS issues
- ✅ **Threat Dragon**: Listed as threat
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-942 - Permissive Cross-domain Policy  
**OWASP Top 10**: A05:2021 - Security Misconfiguration

---

#### 22. Missing Security Headers
**Location**: `.htaccess`, `config.php`

**Detectable By**:
- ✅ **OWASP ZAP**: Detects missing headers
- ✅ **SonarQube**: May flag missing headers
- ✅ **Threat Dragon**: Can be modeled
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**Headers Missing**: X-Frame-Options, X-Content-Type-Options, CSP  
**OWASP Top 10**: A05:2021 - Security Misconfiguration

---

#### 23. Directory Listing Enabled
**Location**: `httpd.conf`

**Detectable By**:
- ✅ **OWASP ZAP**: Detects directory listing
- ⚠️ **SonarQube**: May flag configuration
- ✅ **Threat Dragon**: Can be modeled
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-548 - Directory Indexing  
**OWASP Top 10**: A05:2021 - Security Misconfiguration

---

#### 24. Excessive File Permissions
**Location**: `Dockerfile`, `pages/upload.php`

**Detectable By**:
- ❌ **OWASP ZAP**: Cannot detect file permissions
- ✅ **SonarQube**: May flag dangerous permissions
- ✅ **Threat Dragon**: Listed as "Excessive Permissions"
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-732 - Incorrect Permission Assignment  
**OWASP Top 10**: A05:2021 - Security Misconfiguration

---

#### 25. Use of eval() in JavaScript
**Location**: `assets/js/app.js`

**Detectable By**:
- ⚠️ **OWASP ZAP**: May detect via code review
- ✅ **SonarQube**: **PRIMARY DETECTOR** - Flags eval usage
- ❌ **Threat Dragon**: Manual
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-95 - Eval Injection  
**OWASP Top 10**: A03:2021 - Injection

---

#### 26. Prototype Pollution
**Location**: `assets/js/app.js`

**Detectable By**:
- ⚠️ **OWASP ZAP**: Limited detection
- ✅ **SonarQube**: May flag unsafe object operations
- ❌ **Threat Dragon**: Manual
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-1321 - Prototype Pollution  
**OWASP Top 10**: A08:2021 - Software and Data Integrity Failures

---

#### 27. Insecure Cookies
**Location**: `assets/js/app.js`

**Detectable By**:
- ✅ **OWASP ZAP**: Detects missing cookie flags
- ✅ **SonarQube**: Flags insecure cookie handling
- ✅ **Threat Dragon**: Listed as threat
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-614  
**OWASP Top 10**: A05:2021 - Security Misconfiguration

---

#### 28. Sensitive Data in localStorage
**Location**: `assets/js/app.js`

**Detectable By**:
- ⚠️ **OWASP ZAP**: May detect via passive scan
- ✅ **SonarQube**: Flags sensitive data storage
- ✅ **Threat Dragon**: Can be modeled
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-922 - Insecure Storage of Sensitive Information  
**OWASP Top 10**: A02:2021 - Cryptographic Failures

---

#### 29. No Rate Limiting
**Location**: `api/api.php`, `pages/login.php`

**Detectable By**:
- ⚠️ **OWASP ZAP**: May detect via repeated requests
- ⚠️ **SonarQube**: May flag missing rate limiting
- ✅ **Threat Dragon**: Listed as threat
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-307 - Improper Restriction of Excessive Authentication Attempts  
**OWASP Top 10**: A07:2021 - Identification and Authentication Failures

---

#### 30. Server Information Disclosure
**Location**: `httpd.conf`

**Detectable By**:
- ✅ **OWASP ZAP**: Detects server signature
- ✅ **SonarQube**: May flag server tokens
- ✅ **Threat Dragon**: Can be modeled
- ❌ **Dependency-Check**: N/A
- ❌ **BlackDuck**: N/A

**CWE**: CWE-200 - Information Exposure  
**OWASP Top 10**: A05:2021 - Security Misconfiguration

---

## Tool Detection Summary

### Tool Effectiveness by Category

| Vulnerability Category | Best Tool | Detection Rate |
|------------------------|-----------|----------------|
| **SQL Injection** | ZAP, SonarQube | 100% |
| **XSS** | ZAP, SonarQube | 100% |
| **Hardcoded Secrets** | SonarQube | 100% |
| **Vulnerable Dependencies** | Dependency-Check, BlackDuck | 100% |
| **CSRF** | ZAP | 100% |
| **File Upload** | ZAP, SonarQube | 90% |
| **IDOR** | ZAP | 80% |
| **Missing Auth** | ZAP, SonarQube | 85% |
| **Session Issues** | ZAP, SonarQube | 95% |
| **Security Headers** | ZAP | 100% |

### Overall Coverage

- **OWASP ZAP**: 22/30 vulnerabilities (73%)
- **SonarQube**: 25/30 vulnerabilities (83%)
- **Threat Dragon**: 15/30 vulnerabilities (50% - requires manual modeling)
- **Dependency-Check**: 5/30 vulnerabilities (17% - specialized for dependencies)
- **BlackDuck**: 5/30 vulnerabilities (17% - specialized for dependencies)

**Combined Coverage**: 30/30 (100%) when using all tools together

---

## Detection Matrix

```
Vulnerability           | ZAP | SonarQube | Threat Dragon | Dep-Check | BlackDuck |
------------------------|-----|-----------|---------------|-----------|-----------|
SQL Injection           |  ✅ |    ✅     |      ✅       |    ❌     |    ❌     |
XSS (All Types)         |  ✅ |    ✅     |      ✅       |    ❌     |    ❌     |
Hardcoded Credentials   |  ❌ |    ✅     |      ✅       |    ❌     |    ⚠️     |
Plain Text Passwords    |  ⚠️ |    ✅     |      ✅       |    ❌     |    ❌     |
File Upload RCE         |  ✅ |    ✅     |      ✅       |    ❌     |    ❌     |
IDOR                    |  ✅ |    ⚠️     |      ✅       |    ❌     |    ❌     |
Missing Auth            |  ✅ |    ✅     |      ✅       |    ❌     |    ❌     |
CSRF                    |  ✅ |    ✅     |      ✅       |    ❌     |    ❌     |
Session Issues          |  ✅ |    ✅     |      ✅       |    ❌     |    ❌     |
jQuery Vulnerabilities  |  ❌ |    ⚠️     |      ❌       |    ✅     |    ✅     |
PHP Vulnerabilities     |  ❌ |    ⚠️     |      ❌       |    ✅     |    ✅     |
Composer Dependencies   |  ❌ |    ⚠️     |      ❌       |    ✅     |    ✅     |
CORS Issues             |  ✅ |    ✅     |      ✅       |    ❌     |    ❌     |
Security Headers        |  ✅ |    ✅     |      ⚠️       |    ❌     |    ❌     |
Directory Listing       |  ✅ |    ⚠️     |      ⚠️       |    ❌     |    ❌     |
```

**Legend**:
- ✅ = Reliably detects
- ⚠️ = May detect / partial detection
- ❌ = Does not detect

---

This mapping shows how each security tool complements the others to provide comprehensive coverage of all vulnerabilities in the application.
